# -*- coding: utf-8 -*-
"""DeepLearningintro.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1rxRyv2O-Niyl3Uwj33PAGW3UcHqik6-9
"""

import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import pandas as pd
import numpy as np

import logging
logging.getLogger("tensorflow").setLevel(logging.ERROR)

from sklearn.metrics import accuracy_score

# pip install tensorflow==2.7.0.

# Load dataset
from google.colab import drive
drive.mount('/content/drive')

path = '/content/drive/MyDrive/abc/dataset.csv'
dataset = pd.read_csv(path)
# Indipendent Variables
X_train= dataset.iloc[0:5,0:2].values
print(X_train)
# Dependent Variables
Y_train= dataset.iloc[0:5,2].values
print(Y_train)
print("############")
# Indipendent Variables
X_test= dataset.iloc[5:7,0:2].values
print(X_test)
# Dependent Variables
Y_test= dataset.iloc[5:7,2].values
print(Y_test)

model = keras.Sequential()
model.add(layers.Dense(2, activation="relu"))
model.add(layers.Dense(3, activation="relu"))
model.add(layers.Dense(3, activation="relu"))
model.add(layers.Dense(2))

model.compile(optimizer='sgd', loss='mse', metrics=['accuracy'])
# This builds the model for the first time:
model.fit(X_train, Y_train, batch_size=2, epochs=200)

y_pred = model.predict(X_test, batch_size=2)
print(y_pred)
y_pred1D = y_pred.argmax(1)
print(y_pred1D)
print (Y_test)

print(accuracy_score(Y_test,y_pred1D))

model1 = keras.models.load_model('/content/drive/MyDrive/abc/mymodel')

y_pred = model1.predict(X_test, batch_size=2)
print(y_pred)
y_pred1D = y_pred.argmax(1)
print(y_pred1D)
print (Y_test)

model.save('/content/drive/MyDrive/abc/mymodel1')